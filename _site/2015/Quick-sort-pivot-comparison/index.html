<!doctype html>
<!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en" prefix="og: http://ogp.me/ns#"> <![endif]-->
<!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en" prefix="og: http://ogp.me/ns#"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8 oldie" lang="en" prefix="og: http://ogp.me/ns#"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" prefix="og: http://ogp.me/ns#"> <!--<![endif]-->
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="GitHub Pages" />

  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

  <title>Quick sort pivot choose strategy - FullOuterJoin</title>

  
  <meta name="title" content="Quick sort pivot choose strategy" />
  <meta property="og:title" content="Quick sort pivot choose strategy" />
  <meta name="description" content="Comparing the performance of quicksort with different pivot element choosing strategy" />
  <meta property="og:description" content="Comparing the performance of quicksort with different pivot element choosing strategy" />
  <meta property="og:site_name" content="FullOuterJoin" />
  <meta property="og:image" content="" />
  
  <meta name="author" content="vishnu" />

  <meta name="viewport" content="width=device-width,initial-scale=1" />

  <link rel="stylesheet" type="text/css" href="/css/libs/jquery.qtip.min.css" />

  <link rel="stylesheet" type="text/css" href="/css/style.css" />
  <link rel="stylesheet" type="text/css" href="/css/syntax.css" /><!-- syntax highlighting -->
  <!--[if IE]>
      <link rel="stylesheet" type="text/css" href="/css/ie.css" />
  <![endif]-->

  <script src="/js/libs/modernizr-2.5.3.min.js"></script>
</head>

<body>

  <div id="container">
    <aside id="topbar">
      <div class="inner">
        <h1><a href="/">FullOuterJoin</a></h1>

        <ul id="quick-links">
          <li><a href="/">home</a></li>
          <li><a href="/about.html">about</a></li>
        </ul>
      </div>
    </aside>

    <section id="main" role="main">
      <div class="inner">
        <article id="single" class="hentry">
    <header>
        <h1 class="entry-title">
            
            Quick sort pivot choose strategy
            
        </h1>
        <time datetime="2015-03-25T00:00:00+05:30">
            25 March 2015
        </time>
    </header>

    <div class="entry-content">
        <p>Quick sort works by choosing an element x from the list A and places x in the correct position in A (all the elements to the left of x is lesser and all the elements to the right of x are greater than x). Quick sort is again called on the left lesser list and the right greater list to sort them recursively.</p>

<p>Most of the work is done for moving x from its original position to the sorted position. The number of comparisons made with x and other elements of the list depends on the size of the list. If the recursion call had split the list perfectly into two, the work gets reduced by half at each level.</p>

<p>No of splits at level i is <code class="highlighter-rouge">2^i</code><br />
Work done at each split at level i is <code class="highlighter-rouge">n/2^i</code><br />
No of levels is <code class="highlighter-rouge">log(n)</code><br />
So the total work done is <code class="highlighter-rouge">n * log(n)</code><br />
This can also be derived from the <a href="https://en.wikipedia.org/wiki/Master_theorem">master theorem</a></p>

<p>But that is the ideal case, Finding a perfect pivot element is not guaranteed. Based on the pivot the list can be split anywhere between (1, n-1) to (n/2, n/2). If the split keeps happening at (1,n-1), then the work done at each level will be <code class="highlighter-rouge">n</code> and the number of levels will also be <code class="highlighter-rouge">n</code> so the time complexity will be <code class="highlighter-rouge">O(n^2)</code>.</p>

<p>In order not to put too much work in finding the pivot element, letâ€™s see how different strategies affect the performance. I am randomly generating a list of 1,000,000 numbers and sorting them by choosing a pivot from</p>

<ul>
  <li>first element</li>
  <li>last element</li>
  <li>median</li>
</ul>

<p>You might think that finding median would be O(n), but this is a simplified version where we take the 2nd largest element comparing the first, middle and last element from the split list (which takes O(1)).</p>

<p>Heuristically, you can see that there is almost <strong>15%</strong> less comparisons when the pivot is chosen using the median strategy. This comes somewhere between <code class="highlighter-rouge">O(n^2)</code> and <code class="highlighter-rouge">O(n*log(n))</code> since the split is still not guaranteed to be exactly half.</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">random</span>

<span class="k">def</span> <span class="nf">quick_sort</span><span class="p">(</span><span class="n">numbers</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">pivot_chooser</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">start</span> <span class="o">&lt;</span> <span class="n">end</span><span class="p">:</span>
            <span class="n">pivot_index</span> <span class="o">=</span> <span class="n">pivot_chooser</span><span class="p">(</span><span class="n">numbers</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
            <span class="n">numbers</span><span class="p">[</span><span class="n">start</span><span class="p">],</span> <span class="n">numbers</span><span class="p">[</span><span class="n">pivot_index</span><span class="p">]</span> <span class="o">=</span> <span class="n">numbers</span><span class="p">[</span><span class="n">pivot_index</span><span class="p">],</span> <span class="n">numbers</span><span class="p">[</span><span class="n">start</span><span class="p">]</span>
            <span class="n">pivot</span> <span class="o">=</span> <span class="n">numbers</span><span class="p">[</span><span class="n">start</span><span class="p">]</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">start</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">numbers</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">pivot</span><span class="p">:</span>
                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">numbers</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">numbers</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">numbers</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">numbers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

            <span class="n">numbers</span><span class="p">[</span><span class="n">start</span><span class="p">],</span> <span class="n">numbers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">numbers</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">numbers</span><span class="p">[</span><span class="n">start</span><span class="p">]</span>
            <span class="k">return</span> <span class="p">((</span><span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span> <span class="o">+</span>
                     <span class="n">quick_sort</span><span class="p">(</span><span class="n">numbers</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">pivot_chooser</span><span class="p">)</span> <span class="o">+</span>
                     <span class="n">quick_sort</span><span class="p">(</span><span class="n">numbers</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">pivot_chooser</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>


<span class="k">def</span> <span class="nf">find_median_index</span><span class="p">(</span><span class="n">numbers</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">):</span>
        <span class="n">first</span> <span class="o">=</span> <span class="n">numbers</span><span class="p">[</span><span class="n">start</span><span class="p">],</span> <span class="n">start</span>
        <span class="n">last</span> <span class="o">=</span> <span class="n">numbers</span><span class="p">[</span><span class="n">end</span><span class="p">],</span> <span class="n">end</span>
        <span class="n">mid_index</span> <span class="o">=</span> <span class="p">(</span><span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">start</span>
        <span class="n">middle</span> <span class="o">=</span> <span class="n">numbers</span><span class="p">[</span><span class="n">mid_index</span><span class="p">],</span> <span class="n">mid_index</span>
        <span class="n">pivot_candidates</span> <span class="o">=</span> <span class="p">[</span><span class="n">first</span><span class="p">,</span> <span class="n">middle</span><span class="p">,</span> <span class="n">last</span><span class="p">]</span>
        <span class="n">pivot_candidates</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">pivot_candidates</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>


<span class="n">numbers</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="nb">xrange</span><span class="p">(</span><span class="mi">1000000</span><span class="p">),</span> <span class="mi">1000000</span><span class="p">)</span>
<span class="n">n1</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span>
<span class="n">n2</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span>
<span class="n">n3</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&quot;First Element Pick </span><span class="si">%d</span><span class="s">&quot;</span> <span class="o">%</span><span class="n">quick_sort</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">n1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">:</span> <span class="n">start</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&quot;Last Element Pick </span><span class="si">%d</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">quick_sort</span><span class="p">(</span><span class="n">n2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">n2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">:</span> <span class="n">end</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&quot;Median Element Pick </span><span class="si">%d</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">quick_sort</span><span class="p">(</span><span class="n">n3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">n3</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">find_median_index</span><span class="p">)</span></code></pre></div>

<p>Output:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>First Element Pick 24620279
Last Element Pick 24409932
Median Element Pick 20920898
</code></pre>
</div>


    </div>
</article>


<div id="related">
    <h2>Related Posts</h2>
    <ul class="posts">
        
        <li><span>20 May 2015</span> &raquo; <a href="/2015/Dependency-Injection/">Dependency Injection</a></li>
        
        <li><span>10 May 2015</span> &raquo; <a href="/2015/Coding-to-Interfaces/">Coding to Interfaces</a></li>
        
        <li><span>29 Apr 2015</span> &raquo; <a href="/2015/Perils-of-Mutability/">Perils of Mutability</a></li>
        
    </ul>
</div>


<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = 'fullouterjoin';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

        <footer>
	        <div class="vcard">
            <a class="email fn n" href="mailto: vishnu.carbon@gmail.com">
              <span class="given-name">vishnu</span>
            </a> &mdash; <span class="adr">
              <span class="locality">Coimbatore</span>, <span class="region">Tamil Nadu</span>
            </span>
	        </div>
        </footer>
      </div>
    </section>
  </div>

  <script type="text/javascript" src="//cdn.jsdelivr.net/jquery/1.8.3/jquery-1.8.3.min.js"></script>
  <script type="text/javascript" src="/js/libs/jquery.qtip.min.js"></script>
  <script type="text/javascript" src="/js/script.js"></script>

</body>
</html>
